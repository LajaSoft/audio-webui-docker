---
version: "3.8"
services:
  app:
    build:
      context: https://github.com/LajaSoft/audio-webui-docker.git#master
      dockerfile: Dockerfile
    volumes:
      - ./MUSICGEN_ROOT:${MUSICGEN_ROOT:-/app/MUSICGEN_ROOT}
      - ./HF_HOME:${HF_HOME:-/app/HF_HOME}
      - ./.container-cache:/root/.cache
      - ./venv:/app/audio-webui/venv
    env_file:
      - .env
    ports:
      - ${HOST_PORT:-7860}:${HOST_PORT:-7860}
    stdin_open: true
    tty: true
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: ["0"]
              capabilities: [gpu]
